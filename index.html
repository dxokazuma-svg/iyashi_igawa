<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ç™’ã—å¾…å¤¢ çµ¦æ–™è¨ˆç®—ï¼ˆäº•å·ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰</title>

<style>
:root{
  --pink:#F6A5C0;
  --pink-soft:#FDE7EF;
  --pink-strong:#E85A8A;
  --border:#F6A5C0;
  --muted:#666;
}

body{
  font-family:-apple-system,BlinkMacSystemFont,"Noto Sans JP",sans-serif;
  background:#fff;
  margin:0;
}

header{
  background:var(--pink);
  color:#fff;
  text-align:center;
  padding:14px;
  font-weight:800;
}

.container{padding:14px;max-width:520px;margin:0 auto;}

.card{
  background:var(--pink-soft);
  border-radius:14px;
  padding:14px;
  margin-bottom:12px;
}

h3{margin:0 0 10px;font-size:16px;}

select{
  width:100%;
  padding:12px;
  font-size:18px;
  border-radius:12px;
  border:2px solid var(--border);
  font-weight:800;
}

.btn-row{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
}

.course-btn{
  flex:1 1 30%;
  padding:14px 10px;
  border-radius:12px;
  border:2px solid var(--border);
  background:#fff;
  color:var(--pink);
  font-weight:800;
  font-size:14px;
}

.course-btn.active{
  background:var(--pink);
  color:#fff;
}

.result{text-align:center;}
.label{color:var(--muted);font-size:14px;}
.value{font-size:34px;color:var(--pink-strong);font-weight:900;}
.value.small{font-size:30px;}

.primary{
  width:100%;
  border:none;
  border-radius:14px;
  padding:14px;
  font-size:17px;
  font-weight:900;
  background:var(--pink);
  color:#fff;
}

.list{background:#fff;border-radius:14px;padding:10px;border:2px solid #f3b7cc;}

.row{
  display:grid;
  grid-template-columns:1fr 1fr 1fr 1fr 1fr auto;
  gap:6px;
  padding:6px;
  font-size:13px;
  border-bottom:1px solid #eee;
}

.row.head{font-weight:900;color:#666;}
.cell.back{color:var(--pink-strong);font-weight:900;}

.sticky{
  background:var(--pink-soft);
  border:2px solid #f3b7cc;
  border-radius:14px;
  padding:10px;
  margin-top:10px;
  font-weight:900;
}
</style>
</head>

<body>
<header>
ç™’ã—å¾…å¤¢<br>
<small>çµ¦æ–™è¨ˆç®—ï¼ˆäº•å·ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰</small>
</header>

<div class="container">

<!-- â‘  ãŠå®¢ã•ã‚“é‡‘é¡ -->
<div class="card">
  <h3>ãŠå®¢ã•ã‚“é‡‘é¡</h3>
  <select id="price">
    <option value="0">é¸æŠã—ã¦ãã ã•ã„</option>
  </select>
</div>

<!-- â‘¡ ã‚³ãƒ¼ã‚¹ -->
<div class="card">
  <h3>ã‚³ãƒ¼ã‚¹</h3>
  <div class="btn-row">
    <button class="course-btn" data-course="90">90åˆ†</button>
    <button class="course-btn" data-course="120">120åˆ†</button>
    <button class="course-btn" data-course="150">150åˆ†</button>
    <button class="course-btn" data-course="ext30">å»¶é•·30åˆ†</button>
    <button class="course-btn" data-course="ext60">å»¶é•·60åˆ†</button>
  </div>
</div>

<!-- çµæœ -->
<div class="card result">
  <div class="label">ä»Šå›ã®ãƒãƒƒã‚¯</div>
  <div class="value" id="back">Â¥ 0</div>

  <div style="height:10px;"></div>

  <div class="label">ä»Šå›ã®åº—è½ã¡</div>
  <div class="value small" id="shop">Â¥ 0</div>
</div>

<button class="primary" id="addBtn">ã“ã®å†…å®¹ã‚’è¿½åŠ </button>

<!-- å±¥æ­´ -->
<div class="card">
  <h3>ä»Šæ—¥ã®å±¥æ­´</h3>
  <div class="list" id="listArea"></div>
  <div class="sticky" id="totalArea"></div>
</div>

</div>

<script>
// ===== äº•å·ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼šãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ« =====
function getBack(course){
  if(course === "90") return 9000;
  if(course === "120") return 11000;
  if(course === "150") return 13000;
  if(course === "ext30") return 3000;
  if(course === "ext60") return 6000;
  return 0;
}

// ===== é‡‘é¡ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ç”Ÿæˆ =====
const priceSelect = document.getElementById("price");

// ã‚«ãƒ¼ãƒ‰æ±ºæ¸ˆï¼ˆ0å††ï¼‰ã ã‘æ®‹ã™
const zero = document.createElement("option");
zero.value = 0;
zero.textContent = "ã‚«ãƒ¼ãƒ‰æ±ºæ¸ˆï¼ˆ0å††ï¼‰";
priceSelect.appendChild(zero);

// é€šå¸¸åˆ† 12000ã€œ100000ï¼ˆ1000å††åˆ»ã¿ï¼‰
for(let p = 12000; p <= 100000; p += 1000){
  const o = document.createElement("option");
  o.value = p;
  o.textContent = p;
  priceSelect.appendChild(o);
}

// ===== çŠ¶æ…‹ =====
let selectedCourse = "";

// ã‚³ãƒ¼ã‚¹ãƒœã‚¿ãƒ³å‡¦ç†
document.querySelectorAll(".course-btn").forEach(btn => {
  btn.addEventListener("click", function(){
    selectedCourse = this.dataset.course;

    document.querySelectorAll(".course-btn").forEach(b=>{
      b.classList.remove("active");
    });
    this.classList.add("active");

    calculate();
  });
});

// é‡‘é¡å¤‰æ›´æ™‚
priceSelect.addEventListener("change", calculate);

// ===== è¨ˆç®— =====
function calculate(){
  const price = Number(priceSelect.value || 0);
  const back = getBack(selectedCourse);
  const shop = price - back;

  document.getElementById("back").textContent = `Â¥ ${back.toLocaleString()}`;
  document.getElementById("shop").textContent = `Â¥ ${shop.toLocaleString()}`;
}

// ===== ä¿å­˜ï¼ˆä»Šæ—¥åˆ†ã ã‘ï¼‰ =====
function load(){
  const raw = localStorage.getItem("iyashimayu_igawa_today");
  return raw ? JSON.parse(raw) : [];
}
function save(r){
  localStorage.setItem("iyashimayu_igawa_today", JSON.stringify(r));
}

// è¿½åŠ ãƒœã‚¿ãƒ³
document.getElementById("addBtn").addEventListener("click", function(){
  if(!selectedCourse){
    alert("ã‚³ãƒ¼ã‚¹ã‚’é¸æŠã—ã¦ãã ã•ã„");
    return;
  }

  const price = Number(priceSelect.value || 0);
  const back = getBack(selectedCourse);
  const shop = price - back;

  const rec = { course: selectedCourse, price, back, shop };
  const data = load();
  data.push(rec);
  save(data);
  render();
});

// ===== è¡¨ç¤º =====
function render(){
  const list = document.getElementById("listArea");
  const total = document.getElementById("totalArea");
  const data = load();

  if(data.length === 0){
    list.innerHTML = "<div style='text-align:center;color:#666;'>å±¥æ­´ãªã—</div>";
  }else{
    let html = `<div class="row head">
      <div>ã‚³ãƒ¼ã‚¹</div><div></div><div>é‡‘é¡</div><div>ãƒãƒƒã‚¯</div><div>åº—è½ã¡</div><div></div>
    </div>`;
    data.forEach((r,i)=>{
      html += `<div class="row">
        <div>${r.course}</div>
        <div></div>
        <div>${r.price}</div>
        <div class="cell back">${r.back}</div>
        <div>${r.shop}</div>
        <button onclick="del(${i})">ğŸ—‘</button>
      </div>`;
    });
    list.innerHTML = html;
  }

  const count = data.length;
  const sumBack = data.reduce((s,r)=>s+r.back,0);
  const sumShop = data.reduce((s,r)=>s+r.shop,0);

  total.innerHTML = `
    æœ¬æ•°ï¼š${count} æœ¬<br>
    ãƒãƒƒã‚¯åˆè¨ˆï¼šÂ¥ ${sumBack.toLocaleString()}<br>
    åº—è½ã¡åˆè¨ˆï¼šÂ¥ ${sumShop.toLocaleString()}
  `;
}

function del(i){
  const d = load();
  d.splice(i,1);
  save(d);
  render();
}

// åˆæœŸè¡¨ç¤º
render();
calculate();
</script>

</body>
</html>
